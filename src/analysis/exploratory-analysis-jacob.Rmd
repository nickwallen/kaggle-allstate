Kaggle Allstate Purchase Prediction Competition
========================================================

Of course, start out by loading the source data sets.

```{r fetch.data,message=FALSE}
library(randomForest)
source ("../R/fetch.R")
source ("../R/utils.R")
train <- fetch()

```


Frequency of Each Plan Variation

``` {r count.plans}

train[, plan := paste0(option.a,option.b,option.c,option.d,option.e,option.f,option.g)]
ct.prod <- train[, list(ct = length(customer.id)),by=plan]
ggplot(ct.prod,aes(ct))+geom_histogram()

ggplot(ct.prod,aes(ct))+stat_ecdf()


```

Build "Naive" Model Based only on Customer Attributes & Purchase Points
========================================================================

```{r cust.model,message=FALSE}
buy <- train[record.type == "purchase"]

buy.in <- buy[state == "IN"]

form <- as.formula(paste0("option.a~",paste("day.of.week",
                                 "time.of.day.hours",
                                # "state",
                                # "location",
                                 "group.size",
                                 "homeowner",
                                 "car.age",
                                 "car.value",
                                 "risk.factor",
                                 "age.oldest",
                                 "age.youngest",
                                 "married.couple",
                                 "option.c.previous",
                                 "duration.previous",sep='+')))

fit.a <- randomForest(form, data= buy, ntree = 100,na.action=na.omit)


 ```


